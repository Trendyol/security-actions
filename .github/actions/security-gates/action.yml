iname: "Security Gates Composite Action"
description: "Güvenlik tarama adımlarını içeren composite action"
inputs:
  example-input:
    description: "Örnek input"
    required: false
    default: ""
runs:
  using: "composite"
  steps:
    - name: Repository Görünürlüğünü Kontrol Et
      shell: bash
      run: |
        visibility=$(gh api /repos/$GITHUB_REPOSITORY --jq '.visibility')
        echo "Repository visibility: $visibility"
        if [ "$visibility" != "public" ]; then
          echo "::warning ::Repository public değil, bazı taramalar atlanabilir."
        fi

    - name: Gitleaks Taramasını Çalıştır
      shell: bash
      run: |
        ./gitleaks detect --redact --exit-code 1

    - name: Semgrep Taramasını Çalıştır
      shell: bash
      run: |
        python3 -m pip install semgrep
        semgrep ci --config=auto --text

